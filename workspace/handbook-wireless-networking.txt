30.3. 무선 네트워킹

Loader, Marc Fonvieille and Murray Stokely.

30.3.1. 무선 네트워킹의 기본

대부분의 무선 네트워크는 IEEE® 802.11 표준을 기반으로 하고 있습니다.  기본적인 무선 네트워크는 2.4GHz 또는 5GHz의 전파로 통신하는 여러 개의 스테이션들로 이루어져 있는데, 이 주파수는 지역에 따라 또는 2.3GHz에서 4.9GHz 범위에서의 통신을 가능하도록 하기 위해 달라질 수도 있습니다.

802.11 네트워크는 두 가지 방식으로 구성되어 있습니다.  infrastructure mode에서는, 하나의 스테이션이 마스터로 활동하고 다른 모든 스테이션들은 이에 연관되어져 동작하는데, 이러한 네트워크는 BSS라고 알려져 있고, 마스터 스테이션은 액세스 포인트(AP)라고 불려집니다.  BSS에서는, 모든 통신이 AP를 경유해야 합니다; 심지어 하나의 스테이션이 다른 무선 스테이션과 통신하고자 하는 경우에도, 메시지는 AP를 경유해야 합니다.  두 번째 형태의 네트워크에서는, 마스터가 존재하지 않고 스테이션들은 직접 통신합니다.  이러한 형태의 네트워크는 IBSS라고 불리며 흔히 ad-hoc 네트워크라고 알려져 있습니다.

802.11 네트워크는 IEEE® 802.11과 802.11b 표준에 정의된 프로토콜을 사용하여 2.4GHz 밴드에 처음 사용되었습니다.  이 프로토콜의 정의에는 작동 주파수 및 framing과 (통신이 다양한 비율로 이루어질 수 있기 때문에) transmission rates를 포함한 MAC layer 특성들이 포함되어 있습니다.  나중에, 802.11a 표준은 다른 signaling mechanism과 더 높은 transmission rates를 포함해서 5GHz 밴드에서의 동작을 정의했습니다.  Still later, the 802.11g standard defined the use of 802.11a signaling and transmission mechanisms in the 2.4GHz band in such a way as to be backwards compatible with 802.11b networks.

내재된 전송 기술과는 별개로, 802.11 네트워크는 여러 가지 보안 체계들을 가지고 있습니다.  802.11 표준의 원본은 WEP라고 부르는 간단한 보안 프로토콜을 정의했습니다.   This protocol uses a fixed pre-shared key and the RC4 cryptographic cipher to encode data transmitted on a network. Stations must all agree on the fixed key in order to communicate. This scheme was shown to be easily broken and is now rarely used except to discourage transient users from joining networks. Current security practice is given by the IEEE® 802.11i specification that defines new cryptographic ciphers and an additional protocol to authenticate stations to an access point and exchange keys for data communication. Cryptographic keys are periodically refreshed and there are mechanisms for detecting and countering intrusion attempts. Another security protocol specification commonly used in wireless networks is termed WPA, which was a precursor to 802.11i. WPA specifies a subset of the requirements found in 802.11i and is designed for implementation on legacy hardware. Specifically, WPA requires only the TKIP cipher that is derived from the original WEP cipher. 802.11i permits use of TKIP but also requires support for a stronger cipher, AES-CCM, for encrypting data. The AES cipher was not required in WPA because it was deemed too computationally costly to be implemented on legacy hardware.

The other standard to be aware of is 802.11e. It defines protocols for deploying multimedia applications, such as streaming video and voice over IP (VoIP), in an 802.11 network. Like 802.11i, 802.11e also has a precursor specification termed WME (later renamed WMM) that has been defined by an industry group as a subset of 802.11e that can be deployed now to enable multimedia applications while waiting for the final ratification of 802.11e. The most important thing to know about 802.11e and WME/WMM is that it enables prioritized traffic over a wireless network through Quality of Service (QoS) protocols and enhanced media access protocols. Proper implementation of these protocols enables high speed bursting of data and prioritized traffic flow.

FreeBSD supports networks that operate using 802.11a, 802.11b, and 802.11g. The WPA and 802.11i security protocols are likewise supported (in conjunction with any of 11a, 11b, and 11g) and QoS and traffic prioritization required by the WME/WMM protocols are supported for a limited set of wireless devices.

30.3.2. 빠른 시작

컴퓨터를 이미 존재하는 무선 네트워크에연결하는 것은 일상적인 작업입니다.  이 지침은 필요한 단계를 보여 줍니다.

1. 네트워크 관리자로부터 무선 네트워크의 SSID(Service Set Identifier)와 PSK(Pre-Shared Key) 정보를 얻으세요.

2. 무선 어댑터를 파악하세요.  FreeBSD GENERIC 커널은 많은 일반적인 무선 어댑터들에 대한 드라이버를 포함하고 있습니다.  무선 어댑터가 이러한 모델들 중 하나라면, 그것은 ifconfig(8)의 출력 결과에 나타날 것입니다:

    % ifconfig | grep -B3 -i wireless

무선 어댑터가 나타나지 않는다면, 추가적인 커널 모듈이 필요하거나, FreeBSD가 지원하지 않는 모델일 수도 있습니다.

이 예제는 Atheros ath0 무선 어댑터를 보여 줍니다.

3. /etc/wpa_supplicant.conf에 이 네트워크에 대한 정보를 추가하세요.  만약 그 파일이 존재하지 않으면, 새로 만드시면 됩니다.  myssid와 mypsk는 네트워크 관리자로부터 제공받은 SSID 및 PSK 정보로 대체하세요.

network={
	ssid="myssid"
	psk="mypsk"
}

4. 컴퓨터를 시동할 때 네트워크를 설정하기 위해 /etc/rc.conf에 정보를 입력해 줍니다:

wlans_ath0="wlan0"
ifconfig_wlan0="WPA SYNCDHCP"

5. 네트워크에 연결하기 위해 컴퓨터를 재시동하거나, 네트워크 서비스를 재시작하세요:

    # service netif restart

30.3.3. 기본 준비

30.3.3.1. 커널 설정

무선 네트워크를 사용하기 위해서는, 무선 네트워크 카드가 필요하고 커널은 적절한 무선 네트워킹을 지원하도록 설정되어야 합니다.  커널은 필요한 지원만 설정될 수 있도록 여러 개의 모듈들로 나뉘어져 있습니다.

가장 널리 사용되는 무선 장치는 대체로 Atheros의 부품을 사용합니다.  이 장치들은 ath(4)에 의해 지원되고 /boot/loader.conf에 다음의 줄을 추가할 필요가 있습니다:

if_ath_load="YES"

The Atheros driver is split up into three separate pieces: the driver (ath(4)), the hardware support layer that handles chip-specific functions (ath_hal(4)), and an algorithm for selecting the rate for transmitting frames. When this support is loaded as kernel modules, any dependencies are automatically handled. To load support for a different type of wireless device, specify the module for that device. This example is for devices based on the Intersil Prism parts (wi(4)) driver:

if_wi_load="YES"

Note:

이 항목의 예제들은 ath(4) 장치를 사용하고 있고 예제의 장치 이름은 설정에 맞게 바꿔 주어야 합니다.  사용 가능한 무선 드라이버 및 지원되는 어댑터의 목록은 FreeBSD 웹사이트의 Release Information 페이지에 있는 FreeBSD Hardware Notes에서 찾아볼 수 있습니다.  만약 무선 장치에 대한 native FreeBSD 드라이버가 존재하지 않으면, NDIS driver wrapper를 이용해 Windows 드라이버를 사용하는 것이 가능할 수도 있습니다.

더불어, 보안 프로토콜을 위한 암호화 지원을 구현하는 모듈 역시 로드되어야 합니다.  이들은 wlan(4) 모듈의 필요에 의해 동적으로 로드되도록 되어 있지만, 지금은 수동으로 설정되어야 합니다.  다음의 모듈들을 사용할 수 있습니다: wlan_wep(4), wlan_ccmp(4), and wlan_tkip(4).  wlan_ccmp(4)와 wlan_tkip(4) 드라이버는 WPA 또는 802.11i 보안 프로토콜을 사용할 때에만 필요합니다.  만약 네트워크가 암호화를 사용하지 않는다면, wlan_wep(4) 지원은 필요하지 않습니다.  이 모듈들을 시동할 때 로드하려면, 다음을 /boot/loader.conf에 추가하세요:

wlan_wep_load="YES"
wlan_ccmp_load="YES"
wlan_tkip_load="YES"

이 정보들이 /boot/loader.conf에 추가되었다면, FreeBSD 컴퓨터를 재시동하세요.  또는, kldload(8)을 이용해 이 모듈들을 수동으로 로드해주어도 됩니다.

Note:

이 모듈들을 사용하고 싶지 않은 사용자들은, custom 커널 설정 파일에 다음의 내용을 추가해서 드라이버를 커널로 컴파일할 수 있습니다:

device wlan              # 802.11 support
device wlan_wep          # 802.11 WEP support
device wlan_ccmp         # 802.11 CCMP support
device wlan_tkip         # 802.11 TKIP support
device wlan_amrr         # AMRR transmit rate control algorithm
device ath               # Atheros pci/cardbus NIC's
device ath_hal           # pci/cardbus chip support
options AH_SUPPORT_AR5416 # enable AR5416 tx/rx descriptors
device ath_rate_sample   # SampleRate tx rate control for ath

이 내용을 커널 설정 파일에 적은 뒤, 커널을 다시 컴파일하고 FreeBSD 컴퓨터를 재시동하세요.

무선 장치에 대한 정보가 부트 메시지에 다음과 같은 형태로 나타나야 합니다:

ath0: <Atheros 5212> mem 0x88000000-0x8800ffff irq 11 at device 0.0 on cardbus1
ath0: [ITHREAD]
ath0: AR2413 mac 7.9 RF2413 phy 4.5

30.3.4. Infrastructure Mode

Infrastructure (BSS) Mode는 일반적으로 사용되는 모드입니다.  이 모드에서, 무선 액세스 포인트들은 유선 네트워크에 연결됩니다.  각 무선 네트워크는 SSID라고 불리는 고유한 이름을 가지고 있습니다.  무선 클라이언트들은 무선 액세스 포인트에 접속합니다.

30.3.4.1. FreeBSD 클라이언트

30.3.4.1.1. 액세스 포인트를 찾는 방법

사용 가능한 네트워크를 스캔하기 위해서는, ifconfig(8)를 사용하세요.  시스템이 사용 가능한 각 무선 주파수로 설정을 바꾸어 가면서 액세스 포인트를 찾아내야 하기 때문에, 몇 분정도 시간이 걸릴 수 있습니다.  superuser만이 이 스캔을 시작할 수 있습니다:

# ifconfig wlan0 create wlandev ath0
# ifconfig wlan0 up scan
SSID/MESH ID    BSSID              CHAN RATE   S:N     INT CAPS
dlinkap         00:13:46:49:41:76   11   54M -90:96   100 EPS  WPA WME
freebsdap       00:11:95:c3:0d:ac    1   54M -83:96   100 EPS  WPA

Note:

인터페이스는 스캔을 시작하기 전에 up 상태여야 합니다.  그 이후의 스캔 요청은 인터페이스의 up 상태를 다시 필요로 하지는 않습니다.

스캔 요청의 출력 결과는 발견된 BSS/IBSS 네트워크를 나열합니다.  네트워크의 이름인 SSID 옆에는, 액세스 포인트의 MAC address인 BSSID 역시 보여집니다.  CAPS 필드는 각 네트워크의 타입과 해당 네트워크에서 작동 중인 스테이션의 capability를 나타냅니다:

Table 30.2. Station Capability Codes

Capability Code
Meaning

E
Extended Service Set (ESS). Indicates that the station is part of an infrastructure network rather than an IBSS/ad-hoc network.

I
IBSS/ad-hoc network. Indicates that the station is part of an ad-hoc network rather than an ESS network.

P
Privacy. Encryption is required for all data frames exchanged within the BSS using cryptographic means such as WEP, TKIP or AES-CCMP.

S
Short Preamble. Indicates that the network is using short preambles, defined in 802.11b High Rate/DSSS PHY, and utilizes a 56 bit sync field rather than the 128 bit field used in long preamble mode.

s
Short slot time. Indicates that the 802.11g network is using a short slot time because there are no legacy (802.11b) stations present.

현재 알려진 네트워크의 목록은 다음을 통해 얻을 수 있습니다:

# ifconfig wlan0 list scan

이 정보는 어댑터에 의해 자동적으로 또는 scan 요청에 의해 수동적으로 업데이트될 수 있습니다.  오래된 정보는 캐시로부터 자동적으로 삭제되기 때문에, 스캔이 더 이루어지지 않으면 시간이 지남에 따라 이 목록은 감소할 수 있습니다.

30.3.4.1.2. 기본 설정

이 항목은 FreeBSD에서 무선 네트워크 어댑터를 암호화 없이 작동시키는 방법을 설명합니다.  이 방법에 한번 익숙해지면, 무선 네트워크를 설정하기 위해 WPA를 사용할 것을 강력히 권장합니다.

무선 네트워크를 설정하기 위해서는 세 개의 기본 단계가 필요합니다: 액세스 포인트 선택하기, 스테이션 인증하기, 그리고 IP 주소 설정하기가 그것들입니다.  아래 항목은 각 단계를 설명합니다.

30.3.4.1.2.1. 액세스 포인트 선택하기

